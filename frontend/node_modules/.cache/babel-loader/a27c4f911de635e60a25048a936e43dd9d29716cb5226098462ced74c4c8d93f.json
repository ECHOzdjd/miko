{"ast":null,"code":"import _objectSpread from\"D:/miko/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useParams,Link,useNavigate}from'react-router-dom';import{useQuery,useMutation,useQueryClient}from'react-query';import{ArrowLeft,Heart,MessageCircle,Bookmark,Eye,Trash2,MoreHorizontal}from'lucide-react';import{postsApi}from'../api/posts';import{useAuthStore}from'../stores/authStore';import CommentList from'../components/Comment/CommentList';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PostDetail=()=>{const{postId}=useParams();const navigate=useNavigate();const queryClient=useQueryClient();const{user}=useAuthStore();const[selectedImageIndex,setSelectedImageIndex]=useState(null);const[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const[showMoreOptions,setShowMoreOptions]=useState(false);const[isLiking,setIsLiking]=useState(false);const[isBookmarking,setIsBookmarking]=useState(false);const{data:post,isLoading,error}=useQuery(['post',postId],()=>postsApi.getPost(Number(postId)),{enabled:!!postId});// 本地状态用于即时UI更新\nconst[localPost,setLocalPost]=useState(null);// 当post数据变化时更新本地状态\nReact.useEffect(()=>{if(post){setLocalPost(post);}},[post]);// 删除帖子\nconst deletePostMutation=useMutation({mutationFn:()=>postsApi.deletePost(Number(postId)),onSuccess:()=>{queryClient.invalidateQueries(['userPosts']);queryClient.invalidateQueries(['posts']);toast.success('帖子删除成功');navigate('/');},onError:()=>{toast.error('删除失败，请稍后重试');}});if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-gray-200 rounded w-1/3 mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 rounded w-1/2 mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 rounded w-2/3\"})]})})});}if(error||!post||!localPost){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"\\u5E16\\u5B50\\u4E0D\\u5B58\\u5728\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"\\u8BE5\\u5E16\\u5B50\\u53EF\\u80FD\\u5DF2\\u88AB\\u5220\\u9664\\u6216\\u4E0D\\u5B58\\u5728\\u3002\"}),/*#__PURE__*/_jsxs(Link,{to:\"/\",className:\"inline-flex items-center mt-4 text-primary-600 hover:text-primary-700\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"w-4 h-4 mr-2\"}),\"\\u8FD4\\u56DE\\u9996\\u9875\"]})]})});}const handleImageClick=index=>{setSelectedImageIndex(index);};const closeImageModal=()=>{setSelectedImageIndex(null);};const nextImage=()=>{if(selectedImageIndex!==null&&localPost!==null&&localPost!==void 0&&localPost.images){setSelectedImageIndex((selectedImageIndex+1)%localPost.images.length);}};const prevImage=()=>{if(selectedImageIndex!==null&&localPost!==null&&localPost!==void 0&&localPost.images){setSelectedImageIndex(selectedImageIndex===0?localPost.images.length-1:selectedImageIndex-1);}};const handleDeletePost=()=>{setShowDeleteConfirm(true);};const confirmDeletePost=()=>{deletePostMutation.mutate();};const cancelDeletePost=()=>{setShowDeleteConfirm(false);};const handleLike=async()=>{if(!localPost||isLiking)return;try{setIsLiking(true);// 立即更新本地状态（乐观更新）\nsetLocalPost(prev=>prev?_objectSpread(_objectSpread({},prev),{},{is_liked:!prev.is_liked,likes_count:prev.is_liked?prev.likes_count-1:prev.likes_count+1}):null);const result=await postsApi.toggleLike(localPost.id);// 更新React Query缓存\nqueryClient.setQueryData(['post',postId],oldData=>{if(!oldData)return oldData;return _objectSpread(_objectSpread({},oldData),{},{is_liked:result.status==='liked',likes_count:result.likes_count});});// 同步本地状态与服务器响应\nsetLocalPost(prev=>prev?_objectSpread(_objectSpread({},prev),{},{is_liked:result.status==='liked',likes_count:result.likes_count}):null);toast.success(result.status==='liked'?'点赞成功':'取消点赞');}catch(error){console.error('点赞失败:',error);toast.error('操作失败，请稍后重试');// 发生错误时回滚本地状态\nsetLocalPost(prev=>prev?_objectSpread(_objectSpread({},prev),{},{is_liked:!prev.is_liked,likes_count:prev.is_liked?prev.likes_count+1:prev.likes_count-1}):null);}finally{setIsLiking(false);}};const handleBookmark=async()=>{if(!localPost||isBookmarking)return;try{setIsBookmarking(true);// 立即更新本地状态（乐观更新）\nsetLocalPost(prev=>prev?_objectSpread(_objectSpread({},prev),{},{is_bookmarked:!prev.is_bookmarked,bookmarks_count:prev.is_bookmarked?prev.bookmarks_count-1:prev.bookmarks_count+1}):null);const result=await postsApi.toggleBookmark(localPost.id);// 更新React Query缓存\nqueryClient.setQueryData(['post',postId],oldData=>{if(!oldData)return oldData;return _objectSpread(_objectSpread({},oldData),{},{is_bookmarked:result.status==='bookmarked',bookmarks_count:result.bookmarks_count});});// 同步本地状态与服务器响应\nsetLocalPost(prev=>prev?_objectSpread(_objectSpread({},prev),{},{is_bookmarked:result.status==='bookmarked',bookmarks_count:result.bookmarks_count}):null);toast.success(result.status==='bookmarked'?'收藏成功':'取消收藏');}catch(error){console.error('收藏失败:',error);toast.error('操作失败，请稍后重试');// 发生错误时回滚本地状态\nsetLocalPost(prev=>prev?_objectSpread(_objectSpread({},prev),{},{is_bookmarked:!prev.is_bookmarked,bookmarks_count:prev.is_bookmarked?prev.bookmarks_count+1:prev.bookmarks_count-1}):null);}finally{setIsBookmarking(false);}};const isOwnPost=user&&localPost&&user.id===localPost.author.id;return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(Link,{to:\"/\",className:\"inline-flex items-center text-gray-600 hover:text-gray-900 transition-colors\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"w-5 h-5 mr-2\"}),\"\\u8FD4\\u56DE\\u9996\\u9875\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:localPost.author.avatar_url||'/default-avatar.svg',alt:localPost.author.nickname,className:\"w-12 h-12 rounded-full\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:localPost.author.nickname}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:new Date(localPost.created_at).toLocaleString('zh-CN')})]})]}),isOwnPost&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowMoreOptions(!showMoreOptions),className:\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full transition-colors\",children:/*#__PURE__*/_jsx(MoreHorizontal,{className:\"w-5 h-5\"})}),showMoreOptions&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:handleDeletePost,className:\"w-full px-4 py-2 text-left text-red-600 hover:bg-red-50 flex items-center\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-2\"}),\"\\u5220\\u9664\\u5E16\\u5B50\"]})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-4\",children:localPost.title}),/*#__PURE__*/_jsx(\"div\",{className:\"prose max-w-none\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 leading-relaxed whitespace-pre-wrap\",children:localPost.content})})]}),localPost.images&&localPost.images.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"px-6 pb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\",children:localPost.images.map((imageUrl,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group cursor-pointer\",onClick:()=>handleImageClick(index),children:[/*#__PURE__*/_jsx(\"img\",{src:imageUrl,alt:\"\\u56FE\\u7247 \".concat(index+1),className:\"w-full h-48 object-cover rounded-lg hover:opacity-90 transition-opacity\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(Eye,{className:\"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\"})})]},index))})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-t border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleLike,disabled:isLiking,className:\"flex items-center space-x-2 transition-colors \".concat(localPost.is_liked?'text-red-500':'text-gray-500 hover:text-red-500',\" \").concat(isLiking?'opacity-50 cursor-not-allowed':''),children:[/*#__PURE__*/_jsx(Heart,{className:\"w-5 h-5 \".concat(localPost.is_liked?'fill-current':'')}),/*#__PURE__*/_jsx(\"span\",{children:localPost.likes_count||0})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"flex items-center space-x-2 text-gray-500 hover:text-blue-500 transition-colors\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:localPost.comments_count||0})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleBookmark,disabled:isBookmarking,className:\"flex items-center space-x-2 transition-colors \".concat(localPost.is_bookmarked?'text-yellow-500':'text-gray-500 hover:text-yellow-500',\" \").concat(isBookmarking?'opacity-50 cursor-not-allowed':''),children:[/*#__PURE__*/_jsx(Bookmark,{className:\"w-5 h-5 \".concat(localPost.is_bookmarked?'fill-current':'')}),/*#__PURE__*/_jsx(\"span\",{children:localPost.bookmarks_count||0})]})]})})]}),selectedImageIndex!==null&&(localPost===null||localPost===void 0?void 0:localPost.images)&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative max-w-4xl max-h-full p-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:closeImageModal,className:\"absolute top-4 right-4 text-white hover:text-gray-300 z-10\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})}),/*#__PURE__*/_jsx(\"img\",{src:localPost.images[selectedImageIndex],alt:\"\\u56FE\\u7247 \".concat(selectedImageIndex+1),className:\"max-w-full max-h-full object-contain\"}),localPost.images.length>1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:prevImage,className:\"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 19l-7-7 7-7\"})})}),/*#__PURE__*/_jsx(\"button\",{onClick:nextImage,className:\"absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 5l7 7-7 7\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-sm\",children:[selectedImageIndex+1,\" / \",localPost.images.length]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-100\",children:/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:[\"\\u8BC4\\u8BBA (\",localPost.comments_count||0,\")\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsx(CommentList,{postId:localPost.id})})]}),showDeleteConfirm&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 max-w-md w-full mx-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 w-10 h-10 mx-auto bg-red-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-6 h-6 text-red-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"\\u5220\\u9664\\u5E16\\u5B50\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:[\"\\u786E\\u5B9A\\u8981\\u5220\\u9664\\u5E16\\u5B50 \",/*#__PURE__*/_jsxs(\"strong\",{children:[\"\\\"\",post===null||post===void 0?void 0:post.title,\"\\\"\"]}),\" \\u5417\\uFF1F\\u6B64\\u64CD\\u4F5C\\u65E0\\u6CD5\\u64A4\\u9500\\u3002\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:cancelDeletePost,className:\"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors\",children:\"\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmDeletePost,disabled:deletePostMutation.isLoading,className:\"flex-1 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors\",children:deletePostMutation.isLoading?'删除中...':'删除'})]})]})]})})]});};export default PostDetail;","map":{"version":3,"names":["React","useState","useParams","Link","useNavigate","useQuery","useMutation","useQueryClient","ArrowLeft","Heart","MessageCircle","Bookmark","Eye","Trash2","MoreHorizontal","postsApi","useAuthStore","CommentList","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PostDetail","postId","navigate","queryClient","user","selectedImageIndex","setSelectedImageIndex","showDeleteConfirm","setShowDeleteConfirm","showMoreOptions","setShowMoreOptions","isLiking","setIsLiking","isBookmarking","setIsBookmarking","data","post","isLoading","error","getPost","Number","enabled","localPost","setLocalPost","useEffect","deletePostMutation","mutationFn","deletePost","onSuccess","invalidateQueries","success","onError","className","children","to","handleImageClick","index","closeImageModal","nextImage","images","length","prevImage","handleDeletePost","confirmDeletePost","mutate","cancelDeletePost","handleLike","prev","_objectSpread","is_liked","likes_count","result","toggleLike","id","setQueryData","oldData","status","console","handleBookmark","is_bookmarked","bookmarks_count","toggleBookmark","isOwnPost","author","src","avatar_url","alt","nickname","Date","created_at","toLocaleString","onClick","title","content","map","imageUrl","concat","disabled","comments_count","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d"],"sources":["D:/miko/frontend/src/pages/PostDetail.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useParams, Link, useNavigate } from 'react-router-dom';\r\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\r\nimport { ArrowLeft, Heart, MessageCircle, Bookmark, Eye, Trash2, MoreHorizontal } from 'lucide-react';\r\nimport { postsApi } from '../api/posts';\r\nimport { Post } from '../types/post';\r\nimport { useAuthStore } from '../stores/authStore';\r\nimport CommentList from '../components/Comment/CommentList';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst PostDetail: React.FC = () => {\r\n  const { postId } = useParams<{ postId: string }>();\r\n  const navigate = useNavigate();\r\n  const queryClient = useQueryClient();\r\n  const { user } = useAuthStore();\r\n  const [selectedImageIndex, setSelectedImageIndex] = useState<number | null>(null);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [showMoreOptions, setShowMoreOptions] = useState(false);\r\n  const [isLiking, setIsLiking] = useState(false);\r\n  const [isBookmarking, setIsBookmarking] = useState(false);\r\n\r\n  const { data: post, isLoading, error } = useQuery<Post>(\r\n    ['post', postId],\r\n    () => postsApi.getPost(Number(postId!)),\r\n    {\r\n      enabled: !!postId,\r\n    }\r\n  );\r\n\r\n  // 本地状态用于即时UI更新\r\n  const [localPost, setLocalPost] = useState<Post | null>(null);\r\n  \r\n  // 当post数据变化时更新本地状态\r\n  React.useEffect(() => {\r\n    if (post) {\r\n      setLocalPost(post);\r\n    }\r\n  }, [post]);\r\n\r\n  // 删除帖子\r\n  const deletePostMutation = useMutation({\r\n    mutationFn: () => postsApi.deletePost(Number(postId!)),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(['userPosts']);\r\n      queryClient.invalidateQueries(['posts']);\r\n      toast.success('帖子删除成功');\r\n      navigate('/');\r\n    },\r\n    onError: () => {\r\n      toast.error('删除失败，请稍后重试');\r\n    },\r\n  });\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\r\n          <div className=\"animate-pulse\">\r\n            <div className=\"h-8 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-1/2 mb-2\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-2/3\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !post || !localPost) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">帖子不存在</h1>\r\n          <p className=\"text-gray-600 mt-2\">该帖子可能已被删除或不存在。</p>\r\n          <Link\r\n            to=\"/\"\r\n            className=\"inline-flex items-center mt-4 text-primary-600 hover:text-primary-700\"\r\n          >\r\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n            返回首页\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleImageClick = (index: number) => {\r\n    setSelectedImageIndex(index);\r\n  };\r\n\r\n  const closeImageModal = () => {\r\n    setSelectedImageIndex(null);\r\n  };\r\n\r\n  const nextImage = () => {\r\n    if (selectedImageIndex !== null && localPost?.images) {\r\n      setSelectedImageIndex((selectedImageIndex + 1) % localPost.images.length);\r\n    }\r\n  };\r\n\r\n  const prevImage = () => {\r\n    if (selectedImageIndex !== null && localPost?.images) {\r\n      setSelectedImageIndex(\r\n        selectedImageIndex === 0 ? localPost.images.length - 1 : selectedImageIndex - 1\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleDeletePost = () => {\r\n    setShowDeleteConfirm(true);\r\n  };\r\n\r\n  const confirmDeletePost = () => {\r\n    deletePostMutation.mutate();\r\n  };\r\n\r\n  const cancelDeletePost = () => {\r\n    setShowDeleteConfirm(false);\r\n  };\r\n\r\n  const handleLike = async () => {\r\n    if (!localPost || isLiking) return;\r\n    \r\n    try {\r\n      setIsLiking(true);\r\n      \r\n      // 立即更新本地状态（乐观更新）\r\n      setLocalPost(prev => prev ? {\r\n        ...prev,\r\n        is_liked: !prev.is_liked,\r\n        likes_count: prev.is_liked ? prev.likes_count - 1 : prev.likes_count + 1\r\n      } : null);\r\n      \r\n      const result = await postsApi.toggleLike(localPost.id);\r\n      \r\n      // 更新React Query缓存\r\n      queryClient.setQueryData(['post', postId], (oldData) => {\r\n        if (!oldData) return oldData;\r\n        return {\r\n          ...oldData,\r\n          is_liked: result.status === 'liked',\r\n          likes_count: result.likes_count\r\n        };\r\n      });\r\n      \r\n      // 同步本地状态与服务器响应\r\n      setLocalPost(prev => prev ? {\r\n        ...prev,\r\n        is_liked: result.status === 'liked',\r\n        likes_count: result.likes_count\r\n      } : null);\r\n      \r\n      toast.success(result.status === 'liked' ? '点赞成功' : '取消点赞');\r\n    } catch (error) {\r\n      console.error('点赞失败:', error);\r\n      toast.error('操作失败，请稍后重试');\r\n      \r\n      // 发生错误时回滚本地状态\r\n      setLocalPost(prev => prev ? {\r\n        ...prev,\r\n        is_liked: !prev.is_liked,\r\n        likes_count: prev.is_liked ? prev.likes_count + 1 : prev.likes_count - 1\r\n      } : null);\r\n    } finally {\r\n      setIsLiking(false);\r\n    }\r\n  };\r\n\r\n  const handleBookmark = async () => {\r\n    if (!localPost || isBookmarking) return;\r\n    \r\n    try {\r\n      setIsBookmarking(true);\r\n      \r\n      // 立即更新本地状态（乐观更新）\r\n      setLocalPost(prev => prev ? {\r\n        ...prev,\r\n        is_bookmarked: !prev.is_bookmarked,\r\n        bookmarks_count: prev.is_bookmarked ? prev.bookmarks_count - 1 : prev.bookmarks_count + 1\r\n      } : null);\r\n      \r\n      const result = await postsApi.toggleBookmark(localPost.id);\r\n      \r\n      // 更新React Query缓存\r\n      queryClient.setQueryData(['post', postId], (oldData) => {\r\n        if (!oldData) return oldData;\r\n        return {\r\n          ...oldData,\r\n          is_bookmarked: result.status === 'bookmarked',\r\n          bookmarks_count: result.bookmarks_count\r\n        };\r\n      });\r\n      \r\n      // 同步本地状态与服务器响应\r\n      setLocalPost(prev => prev ? {\r\n        ...prev,\r\n        is_bookmarked: result.status === 'bookmarked',\r\n        bookmarks_count: result.bookmarks_count\r\n      } : null);\r\n      \r\n      toast.success(result.status === 'bookmarked' ? '收藏成功' : '取消收藏');\r\n    } catch (error) {\r\n      console.error('收藏失败:', error);\r\n      toast.error('操作失败，请稍后重试');\r\n      \r\n      // 发生错误时回滚本地状态\r\n      setLocalPost(prev => prev ? {\r\n        ...prev,\r\n        is_bookmarked: !prev.is_bookmarked,\r\n        bookmarks_count: prev.is_bookmarked ? prev.bookmarks_count + 1 : prev.bookmarks_count - 1\r\n      } : null);\r\n    } finally {\r\n      setIsBookmarking(false);\r\n    }\r\n  };\r\n\r\n  const isOwnPost = user && localPost && user.id === localPost.author.id;\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto\">\r\n      {/* 返回按钮 */}\r\n      <div className=\"mb-6\">\r\n        <Link\r\n          to=\"/\"\r\n          className=\"inline-flex items-center text-gray-600 hover:text-gray-900 transition-colors\"\r\n        >\r\n          <ArrowLeft className=\"w-5 h-5 mr-2\" />\r\n          返回首页\r\n        </Link>\r\n      </div>\r\n\r\n      {/* 帖子内容 */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\r\n        {/* 作者信息 */}\r\n        <div className=\"p-6 border-b border-gray-100\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <img\r\n                src={localPost.author.avatar_url || '/default-avatar.svg'}\r\n                alt={localPost.author.nickname}\r\n                className=\"w-12 h-12 rounded-full\"\r\n              />\r\n              <div>\r\n                <h3 className=\"font-medium text-gray-900\">{localPost.author.nickname}</h3>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  {new Date(localPost.created_at).toLocaleString('zh-CN')}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            {isOwnPost && (\r\n              <div className=\"relative\">\r\n                <button\r\n                  onClick={() => setShowMoreOptions(!showMoreOptions)}\r\n                  className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full transition-colors\"\r\n                >\r\n                  <MoreHorizontal className=\"w-5 h-5\" />\r\n                </button>\r\n                {showMoreOptions && (\r\n                  <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10\">\r\n                    <button\r\n                      onClick={handleDeletePost}\r\n                      className=\"w-full px-4 py-2 text-left text-red-600 hover:bg-red-50 flex items-center\"\r\n                    >\r\n                      <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                      删除帖子\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* 帖子标题和内容 */}\r\n        <div className=\"p-6\">\r\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">{localPost.title}</h1>\r\n          <div className=\"prose max-w-none\">\r\n            <p className=\"text-gray-700 leading-relaxed whitespace-pre-wrap\">\r\n              {localPost.content}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 图片展示 */}\r\n        {localPost.images && localPost.images.length > 0 && (\r\n          <div className=\"px-6 pb-6\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n              {localPost.images.map((imageUrl, index) => (\r\n                <div\r\n                  key={index}\r\n                  className=\"relative group cursor-pointer\"\r\n                  onClick={() => handleImageClick(index)}\r\n                >\r\n                  <img\r\n                    src={imageUrl}\r\n                    alt={`图片 ${index + 1}`}\r\n                    className=\"w-full h-48 object-cover rounded-lg hover:opacity-90 transition-opacity\"\r\n                  />\r\n                  <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 rounded-lg flex items-center justify-center\">\r\n                    <Eye className=\"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* 互动按钮 */}\r\n        <div className=\"px-6 py-4 border-t border-gray-100\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-6\">\r\n              <button \r\n                onClick={handleLike}\r\n                disabled={isLiking}\r\n                className={`flex items-center space-x-2 transition-colors ${\r\n                  localPost.is_liked ? 'text-red-500' : 'text-gray-500 hover:text-red-500'\r\n                } ${isLiking ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n              >\r\n                <Heart className={`w-5 h-5 ${localPost.is_liked ? 'fill-current' : ''}`} />\r\n                <span>{localPost.likes_count || 0}</span>\r\n              </button>\r\n              <button className=\"flex items-center space-x-2 text-gray-500 hover:text-blue-500 transition-colors\">\r\n                <MessageCircle className=\"w-5 h-5\" />\r\n                <span>{localPost.comments_count || 0}</span>\r\n              </button>\r\n            </div>\r\n            <button \r\n              onClick={handleBookmark}\r\n              disabled={isBookmarking}\r\n              className={`flex items-center space-x-2 transition-colors ${\r\n                localPost.is_bookmarked ? 'text-yellow-500' : 'text-gray-500 hover:text-yellow-500'\r\n              } ${isBookmarking ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n            >\r\n              <Bookmark className={`w-5 h-5 ${localPost.is_bookmarked ? 'fill-current' : ''}`} />\r\n              <span>{localPost.bookmarks_count || 0}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 图片查看模态框 */}\r\n      {selectedImageIndex !== null && localPost?.images && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center\">\r\n          <div className=\"relative max-w-4xl max-h-full p-4\">\r\n            <button\r\n              onClick={closeImageModal}\r\n              className=\"absolute top-4 right-4 text-white hover:text-gray-300 z-10\"\r\n            >\r\n              <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            <img\r\n              src={localPost.images[selectedImageIndex]}\r\n              alt={`图片 ${selectedImageIndex + 1}`}\r\n              className=\"max-w-full max-h-full object-contain\"\r\n            />\r\n            \r\n            {localPost.images.length > 1 && (\r\n              <>\r\n                <button\r\n                  onClick={prevImage}\r\n                  className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300\"\r\n                >\r\n                  <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                  </svg>\r\n                </button>\r\n                <button\r\n                  onClick={nextImage}\r\n                  className=\"absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300\"\r\n                >\r\n                  <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n                  </svg>\r\n                </button>\r\n              </>\r\n            )}\r\n            \r\n            <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-sm\">\r\n              {selectedImageIndex + 1} / {localPost.images.length}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* 评论区域 */}\r\n      <div className=\"mt-8 bg-white rounded-lg shadow-sm border border-gray-200\">\r\n        <div className=\"p-6 border-b border-gray-100\">\r\n          <h3 className=\"text-lg font-medium text-gray-900\">\r\n            评论 ({localPost.comments_count || 0})\r\n          </h3>\r\n        </div>\r\n        <div className=\"p-6\">\r\n          <CommentList postId={localPost.id} />\r\n        </div>\r\n      </div>\r\n\r\n      {/* 删除确认对话框 */}\r\n      {showDeleteConfirm && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\r\n            <div className=\"flex items-center mb-4\">\r\n              <div className=\"flex-shrink-0 w-10 h-10 mx-auto bg-red-100 rounded-full flex items-center justify-center\">\r\n                <Trash2 className=\"w-6 h-6 text-red-600\" />\r\n              </div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                删除帖子\r\n              </h3>\r\n              <p className=\"text-sm text-gray-500 mb-4\">\r\n                确定要删除帖子 <strong>\"{post?.title}\"</strong> 吗？此操作无法撤销。\r\n              </p>\r\n              <div className=\"flex space-x-3\">\r\n                <button\r\n                  onClick={cancelDeletePost}\r\n                  className=\"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors\"\r\n                >\r\n                  取消\r\n                </button>\r\n                <button\r\n                  onClick={confirmDeletePost}\r\n                  disabled={deletePostMutation.isLoading}\r\n                  className=\"flex-1 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50 transition-colors\"\r\n                >\r\n                  {deletePostMutation.isLoading ? '删除中...' : '删除'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostDetail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}