{"ast":null,"code":"import _objectSpread from\"D:/miko/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import{useQuery}from'react-query';import{postsApi}from'../api/posts';import PostCard from'../components/Post/PostCard';import PostSkeleton from'../components/Post/PostSkeleton';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{var _data$results;const[filters,setFilters]=useState({ordering:'-created_at'});const{data,isLoading,error}=useQuery({queryKey:['posts',filters],queryFn:()=>postsApi.getPosts(filters)});const handleFilterChange=newFilters=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),newFilters));};if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"\\u52A0\\u8F7D\\u5931\\u8D25\\uFF0C\\u8BF7\\u7A0D\\u540E\\u91CD\\u8BD5\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleFilterChange({ordering:'-created_at'}),className:\"px-4 py-2 rounded-full text-sm font-medium transition-colors \".concat(filters.ordering==='-created_at'?'bg-primary-100 text-primary-700':'text-gray-600 hover:bg-gray-100'),children:\"\\u6700\\u65B0\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleFilterChange({ordering:'-likes_count'}),className:\"px-4 py-2 rounded-full text-sm font-medium transition-colors \".concat(filters.ordering==='-likes_count'?'bg-primary-100 text-primary-700':'text-gray-600 hover:bg-gray-100'),children:\"\\u70ED\\u95E8\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleFilterChange({ordering:'-views_count'}),className:\"px-4 py-2 rounded-full text-sm font-medium transition-colors \".concat(filters.ordering==='-views_count'?'bg-primary-100 text-primary-700':'text-gray-600 hover:bg-gray-100'),children:\"\\u6D4F\\u89C8\\u6700\\u591A\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:isLoading?// 骨架屏\nArray.from({length:5}).map((_,index)=>/*#__PURE__*/_jsx(PostSkeleton,{},index)):data!==null&&data!==void 0&&(_data$results=data.results)!==null&&_data$results!==void 0&&_data$results.length?data.results.map(post=>/*#__PURE__*/_jsx(PostCard,{post:post},post.id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"\\u6682\\u65E0\\u5E16\\u5B50\"})})}),(data===null||data===void 0?void 0:data.next)&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-8\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-outline\",children:\"\\u52A0\\u8F7D\\u66F4\\u591A\"})})]});};export default Home;","map":{"version":3,"names":["React","useState","useQuery","postsApi","PostCard","PostSkeleton","jsx","_jsx","jsxs","_jsxs","Home","_data$results","filters","setFilters","ordering","data","isLoading","error","queryKey","queryFn","getPosts","handleFilterChange","newFilters","prev","_objectSpread","className","children","onClick","concat","Array","from","length","map","_","index","results","post","id","next"],"sources":["D:/miko/frontend/src/pages/Home.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useQuery } from 'react-query';\r\nimport { postsApi } from '../api/posts';\r\nimport PostCard from '../components/Post/PostCard';\r\nimport PostSkeleton from '../components/Post/PostSkeleton';\r\nimport { PostFilters } from '../types/post';\r\n\r\nconst Home: React.FC = () => {\r\n  const [filters, setFilters] = useState<PostFilters>({\r\n    ordering: '-created_at',\r\n  });\r\n\r\n  const { data, isLoading, error } = useQuery({\r\n    queryKey: ['posts', filters],\r\n    queryFn: () => postsApi.getPosts(filters),\r\n  });\r\n\r\n  const handleFilterChange = (newFilters: Partial<PostFilters>) => {\r\n    setFilters(prev => ({ ...prev, ...newFilters }));\r\n  };\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <p className=\"text-gray-500\">加载失败，请稍后重试</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto\">\r\n      {/* 筛选器 */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6\">\r\n        <div className=\"flex space-x-4\">\r\n          <button\r\n            onClick={() => handleFilterChange({ ordering: '-created_at' })}\r\n            className={`px-4 py-2 rounded-full text-sm font-medium transition-colors ${\r\n              filters.ordering === '-created_at'\r\n                ? 'bg-primary-100 text-primary-700'\r\n                : 'text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            最新\r\n          </button>\r\n          <button\r\n            onClick={() => handleFilterChange({ ordering: '-likes_count' })}\r\n            className={`px-4 py-2 rounded-full text-sm font-medium transition-colors ${\r\n              filters.ordering === '-likes_count'\r\n                ? 'bg-primary-100 text-primary-700'\r\n                : 'text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            热门\r\n          </button>\r\n          <button\r\n            onClick={() => handleFilterChange({ ordering: '-views_count' })}\r\n            className={`px-4 py-2 rounded-full text-sm font-medium transition-colors ${\r\n              filters.ordering === '-views_count'\r\n                ? 'bg-primary-100 text-primary-700'\r\n                : 'text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            浏览最多\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 帖子列表 */}\r\n      <div className=\"space-y-6\">\r\n        {isLoading ? (\r\n          // 骨架屏\r\n          Array.from({ length: 5 }).map((_, index) => (\r\n            <PostSkeleton key={index} />\r\n          ))\r\n        ) : data?.results?.length ? (\r\n          data.results.map((post: any) => (\r\n            <PostCard key={post.id} post={post} />\r\n          ))\r\n        ) : (\r\n          <div className=\"text-center py-12\">\r\n            <p className=\"text-gray-500\">暂无帖子</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* 加载更多 */}\r\n      {data?.next && (\r\n        <div className=\"text-center mt-8\">\r\n          <button className=\"btn-outline\">\r\n            加载更多\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"mappings":"qGAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,QAAQ,KAAQ,aAAa,CACtC,OAASC,QAAQ,KAAQ,cAAc,CACvC,MAAO,CAAAC,QAAQ,KAAM,6BAA6B,CAClD,MAAO,CAAAC,YAAY,KAAM,iCAAiC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAG3D,KAAM,CAAAC,IAAc,CAAGA,CAAA,GAAM,KAAAC,aAAA,CAC3B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAc,CAClDa,QAAQ,CAAE,aACZ,CAAC,CAAC,CAEF,KAAM,CAAEC,IAAI,CAAEC,SAAS,CAAEC,KAAM,CAAC,CAAGf,QAAQ,CAAC,CAC1CgB,QAAQ,CAAE,CAAC,OAAO,CAAEN,OAAO,CAAC,CAC5BO,OAAO,CAAEA,CAAA,GAAMhB,QAAQ,CAACiB,QAAQ,CAACR,OAAO,CAC1C,CAAC,CAAC,CAEF,KAAM,CAAAS,kBAAkB,CAAIC,UAAgC,EAAK,CAC/DT,UAAU,CAACU,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,EAAKD,UAAU,CAAG,CAAC,CAClD,CAAC,CAED,GAAIL,KAAK,CAAE,CACT,mBACEV,IAAA,QAAKkB,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChCnB,IAAA,MAAGkB,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,8DAAU,CAAG,CAAC,CACxC,CAAC,CAEV,CAEA,mBACEjB,KAAA,QAAKgB,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAEhCnB,IAAA,QAAKkB,SAAS,CAAC,+DAA+D,CAAAC,QAAA,cAC5EjB,KAAA,QAAKgB,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BnB,IAAA,WACEoB,OAAO,CAAEA,CAAA,GAAMN,kBAAkB,CAAC,CAAEP,QAAQ,CAAE,aAAc,CAAC,CAAE,CAC/DW,SAAS,iEAAAG,MAAA,CACPhB,OAAO,CAACE,QAAQ,GAAK,aAAa,CAC9B,iCAAiC,CACjC,iCAAiC,CACpC,CAAAY,QAAA,CACJ,cAED,CAAQ,CAAC,cACTnB,IAAA,WACEoB,OAAO,CAAEA,CAAA,GAAMN,kBAAkB,CAAC,CAAEP,QAAQ,CAAE,cAAe,CAAC,CAAE,CAChEW,SAAS,iEAAAG,MAAA,CACPhB,OAAO,CAACE,QAAQ,GAAK,cAAc,CAC/B,iCAAiC,CACjC,iCAAiC,CACpC,CAAAY,QAAA,CACJ,cAED,CAAQ,CAAC,cACTnB,IAAA,WACEoB,OAAO,CAAEA,CAAA,GAAMN,kBAAkB,CAAC,CAAEP,QAAQ,CAAE,cAAe,CAAC,CAAE,CAChEW,SAAS,iEAAAG,MAAA,CACPhB,OAAO,CAACE,QAAQ,GAAK,cAAc,CAC/B,iCAAiC,CACjC,iCAAiC,CACpC,CAAAY,QAAA,CACJ,0BAED,CAAQ,CAAC,EACN,CAAC,CACH,CAAC,cAGNnB,IAAA,QAAKkB,SAAS,CAAC,WAAW,CAAAC,QAAA,CACvBV,SAAS,CACR;AACAa,KAAK,CAACC,IAAI,CAAC,CAAEC,MAAM,CAAE,CAAE,CAAC,CAAC,CAACC,GAAG,CAAC,CAACC,CAAC,CAAEC,KAAK,gBACrC3B,IAAA,CAACF,YAAY,IAAM6B,KAAQ,CAC5B,CAAC,CACAnB,IAAI,SAAJA,IAAI,YAAAJ,aAAA,CAAJI,IAAI,CAAEoB,OAAO,UAAAxB,aAAA,WAAbA,aAAA,CAAeoB,MAAM,CACvBhB,IAAI,CAACoB,OAAO,CAACH,GAAG,CAAEI,IAAS,eACzB7B,IAAA,CAACH,QAAQ,EAAegC,IAAI,CAAEA,IAAK,EAApBA,IAAI,CAACC,EAAiB,CACtC,CAAC,cAEF9B,IAAA,QAAKkB,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChCnB,IAAA,MAAGkB,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,0BAAI,CAAG,CAAC,CAClC,CACN,CACE,CAAC,CAGL,CAAAX,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEuB,IAAI,gBACT/B,IAAA,QAAKkB,SAAS,CAAC,kBAAkB,CAAAC,QAAA,cAC/BnB,IAAA,WAAQkB,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,0BAEhC,CAAQ,CAAC,CACN,CACN,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAhB,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}